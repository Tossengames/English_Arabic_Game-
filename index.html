<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch≈ç-Han Bakuchi</title>
    <style>
        :root {
            --edo-red: #8b0000;
            --gold: #d4af37;
            --ink-black: #1a1a1a;
            --paper-white: #f4e4bc;
        }

        body {
            background-color: var(--ink-black);
            color: var(--paper-white);
            font-family: 'Georgia', serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            min-height: 100vh;
        }

        .container {
            width: 90%;
            max-width: 500px;
            text-align: center;
            padding: 20px;
        }

        h1 { color: var(--edo-red); text-transform: uppercase; letter-spacing: 3px; }
        .hidden { display: none !important; }

        /* Setup Screen */
        .setup-card, .bet-card, .result-card {
            background: #2a2a2a;
            padding: 20px;
            border: 2px solid var(--gold);
            border-radius: 10px;
        }

        input, select {
            padding: 10px;
            margin: 10px 0;
            width: 80%;
            border-radius: 5px;
            border: none;
        }

        button {
            background-color: var(--edo-red);
            color: white;
            border: 1px solid var(--gold);
            padding: 12px 24px;
            cursor: pointer;
            font-size: 1.1rem;
            margin-top: 15px;
            transition: 0.3s;
        }

        button:hover { background-color: #b30000; transform: scale(1.05); }

        /* Dice Animation */
        .dice-box {
            font-size: 4rem;
            margin: 20px 0;
            height: 100px;
        }

        .shaking { animation: shake 0.2s infinite; }
        @keyframes shake {
            0% { transform: translate(2px, 1px) rotate(0deg); }
            50% { transform: translate(-2px, -1px) rotate(1deg); }
            100% { transform: translate(2px, 1px) rotate(0deg); }
        }

        .player-bet-list { text-align: left; margin: 20px auto; width: 80%; }
        .win { color: #4caf50; font-weight: bold; }
        .loss { color: #f44336; }
    </style>
</head>
<body>

<div class="container">
    <h1>Ch≈ç-Han</h1>

    <div id="setup-screen" class="setup-card">
        <p>How many gamblers?</p>
        <select id="player-count">
            <option value="1">1 Player</option>
            <option value="2">2 Players</option>
            <option value="3">3 Players</option>
            <option value="4">4 Players</option>
            <option value="8">8 Players</option>
        </select>
        <div id="name-inputs"></div>
        <button onclick="startGame()">Enter the Den</button>
    </div>

    <div id="bet-screen" class="bet-card hidden">
        <h2 id="current-player-name">Player Name</h2>
        <p>Choose your destiny:</p>
        <button onclick="recordBet('Ch≈ç')">CH≈å (Even)</button>
        <button onclick="recordBet('Han')">HAN (Odd)</button>
        <p style="font-size: 0.8rem; color: gray; margin-top: 20px;">Pass the phone to the next player after clicking.</p>
    </div>

    <div id="reveal-screen" class="result-card hidden">
        <div id="dice-container" class="dice-box">üèÆ</div>
        <h2 id="result-text">Waiting...</h2>
        <div id="player-results" class="player-bet-list"></div>
        <button onclick="resetRound()">Next Round</button>
    </div>
</div>

<script>
    let players = [];
    let bets = [];
    let currentPlayerIndex = 0;

    // Initialize name inputs based on selection
    document.getElementById('player-count').addEventListener('change', function(e) {
        const count = e.target.value;
        const container = document.getElementById('name-inputs');
        container.innerHTML = '';
        for(let i=1; i<=count; i++) {
            container.innerHTML += `<input type="text" id="p${i}" placeholder="Player ${i} Name" value="Player ${i}">`;
        }
    });
    // Trigger once on load
    document.getElementById('player-count').dispatchEvent(new Event('change'));

    function startGame() {
        const count = document.getElementById('player-count').value;
        players = [];
        for(let i=1; i<=count; i++) {
            players.push(document.getElementById(`p${i}`).value);
        }
        document.getElementById('setup-screen').classList.add('hidden');
        startBettingRound();
    }

    function startBettingRound() {
        currentPlayerIndex = 0;
        bets = [];
        showBettingScreen();
    }

    function showBettingScreen() {
        document.getElementById('bet-screen').classList.remove('hidden');
        document.getElementById('reveal-screen').classList.add('hidden');
        document.getElementById('current-player-name').innerText = players[currentPlayerIndex];
    }

    function recordBet(choice) {
        bets.push(choice);
        currentPlayerIndex++;

        if (currentPlayerIndex < players.length) {
            showBettingScreen();
        } else {
            showRevealScreen();
        }
    }

    function showRevealScreen() {
        document.getElementById('bet-screen').classList.add('hidden');
        document.getElementById('reveal-screen').classList.remove('hidden');
        
        const diceEl = document.getElementById('dice-container');
        const resultEl = document.getElementById('result-text');
        
        // Shaking animation
        diceEl.innerHTML = "üé≤üé≤";
        diceEl.classList.add('shaking');
        resultEl.innerText = "The cup is shaking...";

        setTimeout(() => {
            diceEl.classList.remove('shaking');
            const d1 = Math.floor(Math.random() * 6) + 1;
            const d2 = Math.floor(Math.random() * 6) + 1;
            const sum = d1 + d2;
            const outcome = (sum % 2 === 0) ? 'Ch≈ç' : 'Han';
            
            diceEl.innerText = `${getDiceIcon(d1)} ${getDiceIcon(d2)}`;
            resultEl.innerText = `Result: ${sum} - ${outcome.toUpperCase()}!`;
            
            displayWinners(outcome);
        }, 1500);
    }

    function getDiceIcon(num) {
        const icons = ['','‚öÄ','‚öÅ','‚öÇ','‚öÉ','‚öÑ','‚öÖ'];
        return icons[num];
    }

    function displayWinners(outcome) {
        const list = document.getElementById('player-results');
        list.innerHTML = "<h3>Results:</h3>";
        players.forEach((name, i) => {
            const isWin = bets[i] === outcome;
            list.innerHTML += `<div class="${isWin ? 'win' : 'loss'}">
                ${name}: ${bets[i]} ${isWin ? '‚úì' : '‚úó'}
            </div>`;
        });
    }

    function resetRound() {
        startBettingRound();
    }
</script>

</body>
</html>
